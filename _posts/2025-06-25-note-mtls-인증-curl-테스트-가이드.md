---
title: "[Note] mTLS ì¸ì¦ curl í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ"
date: 2025-06-25 20:00:00 +0900
categories: [note]
layout: single
---

# mTLS ì¸ì¦ì„ ìœ„í•œ curl í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

## ğŸ“Œ ëª©ì 
- ì¹´ë©”ë¼ APIì™€ ì•ˆì „í•˜ê²Œ mTLS(mutual TLS) í†µì‹ ì„ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.
- í´ë¼ì´ì–¸íŠ¸ ì¸ì¦ì„œë¥¼ ì´ìš©í•˜ì—¬ `curl` ëª…ë ¹ì–´ë¡œ APIë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.

---

## 1ï¸âƒ£ í•„ìš”í•œ íŒŒì¼ ì¤€ë¹„
í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ë‹¤ìŒ ì¸ì¦ì„œ íŒŒì¼ì´ í•„ìš”í•©ë‹ˆë‹¤:

| ì¢…ë¥˜ | ì„¤ëª… | ì˜ˆì‹œ íŒŒì¼ëª… |
|------|------|--------------|
| CA ì¸ì¦ì„œ | ì„œë²„ì˜ ì‹ ë¢°ë¥¼ ë³´ì¥í•˜ëŠ” ë£¨íŠ¸ ì¸ì¦ì„œ | `ca.pem`, `rootca.crt` |
| í´ë¼ì´ì–¸íŠ¸ ì¸ì¦ì„œ | í´ë¼ì´ì–¸íŠ¸ì˜ ì‹ ì›ì„ ì¦ëª… | `client.crt`, `client.pem` |
| í´ë¼ì´ì–¸íŠ¸ ê°œì¸ í‚¤ | ì¸ì¦ì„œì˜ ì‹¤ì œ ì†Œìœ ê¶Œ ì¦ëª… | `client.key` ë˜ëŠ” `client.pfx` |

### ğŸ” íŒŒì¼ ìœ„ì¹˜
ë³´í†µ ì¹´ë©”ë¼ ì›¹ í˜ì´ì§€ì˜ 'ì¸ì¦ì„œ ê´€ë¦¬' > 'í´ë¼ì´ì–¸íŠ¸ ì¸ì¦ì„œ' ë©”ë‰´ì—ì„œ ë‹¤ìŒì„ ì‹œë„í•©ë‹ˆë‹¤:
- ê¸°ì¡´ ì¸ì¦ì„œ **ë‚´ë³´ë‚´ê¸°**: `.pfx` ë˜ëŠ” `.zip` ë‹¤ìš´ë¡œë“œ
- ìƒˆ ì¸ì¦ì„œ **ë°œê¸‰(Issue)**: `.pfx`, `.crt` + `.key` ìƒì„±

---

## 2ï¸âƒ£ curl ëª…ë ¹ì–´ êµ¬ì„±

### A. PEM í˜•ì‹ (client.crt + client.key + ca.pem)

```bash
curl --cacert "C:\certs\ca.pem" ^
     --cert "C:\certs\client.crt" ^
     --key "C:\certs\client.key" ^
     --anyauth -u "admin:ë¹„ë°€ë²ˆí˜¸" ^
     "https://<ì¹´ë©”ë¼IP>/stw-cgi/system.cgi?msubmenu=deviceinfo&action=view"
```

### B. PFX í˜•ì‹ (ê°œì¸ í‚¤ í¬í•¨)

```bash
curl --cacert "C:\certs\ca.pem" ^
     --cert-type PFX ^
     --cert "C:\certs\client.pfx" ^
     --pass "pfx-ì•”í˜¸" ^
     --anyauth -u "admin:ë¹„ë°€ë²ˆí˜¸" ^
     "https://<ì¹´ë©”ë¼IP>/stw-cgi/system.cgi?msubmenu=deviceinfo&action=view"
```

> âš ï¸ `-k` ì˜µì…˜ì€ **ë³´ì•ˆ ë¬´ì‹œ**ì´ë¯€ë¡œ, `--cacert` ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤.

---

## 3ï¸âƒ£ ì—°ê²° í™•ì¸ ê²°ê³¼

### âœ… ì„±ê³µ:
- JSON ë˜ëŠ” XML í˜•ì‹ ì‘ë‹µ ìˆ˜ì‹  (ì¹´ë©”ë¼ ì •ë³´ ë“±)

### âŒ ì‹¤íŒ¨:
| ì—ëŸ¬ ë©”ì‹œì§€ | ì›ì¸ |
|-------------|------|
| curl (35) | TLS ì¸ì¦ ì‹¤íŒ¨ (íŒŒì¼ ë¶ˆì¼ì¹˜, ì„œë²„ ë¬¸ì œ) |
| curl (58) | ì¸ì¦ì„œ/í‚¤ ë¶ˆì¼ì¹˜ |
| 401 Unauthorized | ì¸ì¦ì€ ì„±ê³µ, ID/ë¹„ë²ˆ ì˜¤ë¥˜ ê°€ëŠ¥ì„± |

---

## ğŸ”‘ ê°œì¸ í‚¤ê°€ ì—†ëŠ” ê²½ìš° ëŒ€ì²˜ë²•

| ì‹œë‚˜ë¦¬ì˜¤ | ëŒ€ì²˜ ë°©ì•ˆ |
|----------|-----------|
| ì¸ì¦ì„œë§Œ ìˆê³  .key ì—†ìŒ | ì¹´ë©”ë¼ ì›¹ UIì—ì„œ **ìƒˆ ì¸ì¦ì„œ ë°œê¸‰** |
| PEMë§Œ ìˆê³  PFX ì—†ìŒ | `.key` íŒŒì¼ë„ í•¨ê»˜ ë°›ì•˜ëŠ”ì§€ í™•ì¸ ë˜ëŠ” ìƒˆë¡œ ë°œê¸‰ |
| ì „ë‹¬ë°›ì€ .crtë§Œ ìˆìŒ | ë°œê¸‰ìì—ê²Œ `.key` ë˜ëŠ” `.pfx` ìš”ì²­ |

---

## âœ… ê¶Œì¥ êµ¬ì„± ìš”ì•½

| ëª©ì  | í•„ìš”í•œ íŒŒì¼ | ëª…ë ¹ì–´ êµ¬ì„± |
|------|-------------|--------------|
| í†µì‹ ë§Œ ì„±ê³µ | client.crt + client.key | `-k` ì˜µì…˜ í•„ìˆ˜ |
| **ë³´ì•ˆ í¬í•¨ (ê¶Œì¥)** | client.crt + client.key + ca.pem | `--cacert` ì‚¬ìš© |

---

## ğŸ“‚ ì˜ˆì‹œ íŒŒì¼ êµ¬ì¡° (`C:\certs\`)
```
C:\certs\
â”œâ”€â”€ ca.pem
â”œâ”€â”€ client.crt
â”œâ”€â”€ client.key
â””â”€â”€ client.pfx
```

> ì°¸ê³ : PEM í˜•ì‹ì€ ë©”ëª¨ì¥ìœ¼ë¡œ ì—´ì—ˆì„ ë•Œ `-----BEGIN CERTIFICATE-----` ë“± í…ìŠ¤íŠ¸ê°€ ë³´ì„

